## Signs a file
[cmdletbinding()]
param(
    [Parameter(Mandatory=$true)]
    [string] $File
)

$cert = Get-ChildItem Cert:\CurrentUser\My -CodeSigningCert |
    Select-Object -First 1

Set-AuthenticodeSignature -FilePath $File -Certificate $cert

# SIG # Begin signature block
# MIIFlAYJKoZIhvcNAQcCoIIFhTCCBYECAQExCzAJBgUrDgMCGgUAMGkGCisGAQQB
# gjcCAQSgWzBZMDQGCisGAQQBgjcCAR4wJgIDAQAABBAfzDtgWUsITrck0sYpfvNR
# AgEAAgEAAgEAAgEAAgEAMCEwCQYFKw4DAhoFAAQUmi4fCw4p+7a1XG4zu7sQbjS4
# 206gggMiMIIDHjCCAgagAwIBAgIQNGLz8JbP57dHolDWZNhnVzANBgkqhkiG9w0B
# AQsFADAnMSUwIwYDVQQDDBxQb3dlclNoZWxsIENvZGUgU2lnbmluZyBDZXJ0MB4X
# DTI0MDQyOTAwMDAwMFoXDTI1MDQyOTAwMjAwMFowJzElMCMGA1UEAwwcUG93ZXJT
# aGVsbCBDb2RlIFNpZ25pbmcgQ2VydDCCASIwDQYJKoZIhvcNAQEBBQADggEPADCC
# AQoCggEBANojNo0zQ6NjPjNcXU9Tdj6IqUcoEaNI9PC63X6MvOUOaovvX1zJDpY7
# TOL/tGbEiHaWHa6VgMpVqm8FMzMRGGxkt/3mBtWBjZHO3ca1+PTVDEjwKzZT2ZLr
# yPQnNtA0AR4yGEXGpk3QRGXYjjoY9eOm71Nuf5jvz5774N6yhDHy6re9nqOdOqp6
# uNN4oonXZbaqew5E+xGf0YmI27msLWLirS1rfDYQ5OdTGINXIeOAfNnmt8hht2tL
# HB39btrE0UWd3xyKke09sXiF2dBPxHSm2cy2XPUz+uYPdRxhxmf7gSYUZUYS73au
# /+ZP4ui0aSX7OiXHL4dQrhbbIoFrnaECAwEAAaNGMEQwDgYDVR0PAQH/BAQDAgeA
# MBMGA1UdJQQMMAoGCCsGAQUFBwMDMB0GA1UdDgQWBBTCQmPg4w3mwaevTIp2f1/u
# 0kQt8zANBgkqhkiG9w0BAQsFAAOCAQEAQLkWlGpvXDb7MEjxuvw0+Zzg2J+J1cVQ
# yFe25IzygzQh9L5N8EbsAD+xYbpLsqKEr/rcho+K34Ophy0HoLeljeWJlGyon0Lo
# GidnThp8kwIEzXFpr6UBz7KGHhl2jvnNqj8G/KZFRgyDQx8gonJl9E6VKWt5Df6p
# jAqrjTTGJKXX2SXsBvTxgNUYgdF8Egxs9oNid6jPAuAPLI60b2MMbGBtzPX35iQF
# JTLd2wrAj+szkPnxgjZAknTe8xFxHT6aabgllhEyf/mcAsk/yLoGfZAI8VFVxusz
# cdAFyn5kTNKVI0YNgwVoThrs5+HxYdLxamFYJA3r9xhvGtAgz1oAaTGCAdwwggHY
# AgEBMDswJzElMCMGA1UEAwwcUG93ZXJTaGVsbCBDb2RlIFNpZ25pbmcgQ2VydAIQ
# NGLz8JbP57dHolDWZNhnVzAJBgUrDgMCGgUAoHgwGAYKKwYBBAGCNwIBDDEKMAig
# AoAAoQKAADAZBgkqhkiG9w0BCQMxDAYKKwYBBAGCNwIBBDAcBgorBgEEAYI3AgEL
# MQ4wDAYKKwYBBAGCNwIBFTAjBgkqhkiG9w0BCQQxFgQUzgBUTseePD9QTAzXy/++
# pkneBlgwDQYJKoZIhvcNAQEBBQAEggEAjSPMyEpZOAqClha2hIcGNALJCQVlTeVh
# xQ63fw3+xbof31DdIj5SGB8DOP+orW8CGWwNQVWr1wGVf0R2fFYlo0RKGU/zJjG1
# OdPB9w3ogsGEH1OhE+whkSleKYrPYgSEbNDK/9IfqJdkeQm1Qpc85cXq7FMd0gzX
# j4jyfPvrFpN41mYb3UUXE1C0+bFW9Wg7bpDC0wewa8CjENGIEdmgIvWMTEFD3rlF
# /k8EfvYaEiJrpT/TJIWs48f97e45HSBzcedj03i09hR66iz7gdNZlz8kfSAl6MzZ
# dFe64TF5tVr5a+iqmHCLhEjmTNdES77e7pMD0F4fInk437kkHKttvQ==
# SIG # End signature block
